## Twistlock Console Deployment

### Prepare Persistent Volume

Prisma Cloud Console uses a PersistentVolumeClaim to store data. There are two ways to provision storage for Console:

- **Dynamic provisioning:** Allocate storage for Console on-demand at deployment time. When generating the Console deployment YAML files with twistcli, specify the name of the storage class with the --storage-class flag. Most customers use dynamic provisioning.

- **Manual provisioning:** Pre-provision a persistent volume for Console, then specify its label when generating the Console deployment YAML files.

For the purpose of this lab we will manually create the persistant volume against local storage.

In the editor, let's look at **/root/manifests/persistentVolume.yaml** or:

`less manifests/persistentVolume.yaml`{{execute}}

This is the volume we'll create for the console:

`oc create -f manifests/persistentVolume.yaml`{{execute}}

Check the volume is available:

`oc get pv -n twistlock`{{execute}}

### Prepare Deployment File

Now the volume is created, we will use the **twistcli** to generate the console deployment file. The twistcli tool is bundled with the release tarball which we unpacked in **./twistlock**. 

The **twistcli** tool generates YAML for a ReplicationContoller, and other service configurations, such as a PersistentVolumeClaim, SecurityContextConstraints, and so on. Let's see what options are available in the **twistcli**:

`cd twistlock`{{execute}}

`linux/twistcli --help`{{execute}}

We will use the **console export** command to generate the deployment:

```For the following command we will need the restry endpoint. You can retrieve this with: oc get svc -n default```

`linux/twistcli console export openshift --persistent-volume-labels "app-volume=twistlock-console" --image-name "<REGISTRY_ENDPOINT>:5000/twistlock private:console_<VERSION>" --service-type "ClusterIP"`{{execute}}

### Deploy Console

Finally, let's deploy the console:

`oc create -f twistlock_console.yaml`{{execute}}